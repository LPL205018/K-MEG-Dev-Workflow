# é–‹ç™¼ç’°å¢ƒå¿«é€Ÿå•Ÿå‹•æŒ‡å—

> â±ï¸ é æœŸæ™‚é–“ï¼š5-10 åˆ†é˜ï¼ˆé¦–æ¬¡ï¼‰| äºŒæ¬¡å•Ÿå‹•ï¼š<1 åˆ†é˜

---

## ğŸ“‹ å‰ç½®è¦æ±‚

### å¿…éœ€è»Ÿä»¶

- **Docker & Docker Compose**
  - Windows: [Docker Desktop for Windows](https://www.docker.com/products/docker-desktop) (åŒ…å« Docker Compose)
  - Mac: [Docker Desktop for Mac](https://www.docker.com/products/docker-desktop)
  - Linux: `sudo apt-get install docker.io docker-compose-plugin`

- **Git**
  - Windows: [Git for Windows](https://git-scm.com/download/win)
  - Mac/Linux: `brew install git` æˆ–ç™¼è¡Œç‰ˆå¥—ä»¶ç®¡ç†å™¨

### é©—è­‰å®‰è£

```bash
# æª¢æŸ¥ Docker
docker --version
# æœŸæœ›ï¼šDocker version 24.0.0+

docker compose version
# æœŸæœ›ï¼šDocker Compose version v2.20.0+

# æª¢æŸ¥ Git
git --version
# æœŸæœ›ï¼šgit version 2.40.0+
```

---

## ğŸš€ ä¸€éµå•Ÿå‹•ï¼ˆæ¨è–¦ï¼‰

### Step 1: å…‹éš†æˆ–åˆå§‹åŒ–é …ç›®

```bash
# å¦‚æœé‚„æ²’å…‹éš†é …ç›®
git clone https://github.com/your-org/k-meg.git
cd k-meg

# æˆ–é€²å…¥å·²æœ‰é …ç›®
cd /path/to/your/k-meg-project
```

### Step 2: è¤‡è£½ç’°å¢ƒé…ç½®æ–‡ä»¶

```bash
# Python å¾Œç«¯
cp src/backend/python/.env.example src/backend/python/.env

# TypeScript å‰ç«¯
cp src/frontend/.env.example src/frontend/.env

# C# å¾Œç«¯
cp src/backend/csharp/appsettings.Development.json.example src/backend/csharp/appsettings.Development.json
```

**ç¤ºä¾‹ .env æ–‡ä»¶å…§å®¹ï¼š**

```bash
# src/backend/python/.env
ENVIRONMENT=development
DEBUG=true
DATABASE_URL=postgresql://devuser:devpass123@postgres:5432/k_meg_dev
REDIS_URL=redis://redis:6379/0
API_PORT=8000
```

```bash
# src/frontend/.env
VITE_API_URL=http://localhost:8000
VITE_ENVIRONMENT=development
```

### Step 3: å•Ÿå‹•æ‰€æœ‰æœå‹™

```bash
# é€²å…¥é …ç›®æ ¹ç›®éŒ„
cd your-k-meg-project

# ä¸€éµå•Ÿå‹•æ‰€æœ‰å®¹å™¨
docker compose up -d

# æŸ¥çœ‹å®¹å™¨ç‹€æ…‹
docker compose ps

# æœŸæœ›çœ‹åˆ°ï¼š
# NAME                COMMAND                  SERVICE             STATUS
# k-meg-postgres      "docker-entrypoint..."  postgres            Up X seconds (healthy)
# k-meg-redis         "redis-server --ap..."  redis               Up X seconds (healthy)
# k-meg-backend-py... "bash -c 'pip insta..." backend-python      Up X seconds
# k-meg-backend-c...  "dotnet run"            backend-csharp      Up X seconds
# k-meg-frontend      "npm run dev"           frontend            Up X seconds
```

### Step 4: é©—è­‰æ‰€æœ‰æœå‹™æ˜¯å¦æ­£å¸¸

```bash
# Python FastAPI
curl http://localhost:8000/health
# æœŸæœ›ï¼š{"status":"ok"}

# TypeScript React å‰ç«¯
open http://localhost:5173
# æˆ–ç”¨ç€è¦½å™¨è¨ªå• http://localhost:5173

# C# .NET
curl http://localhost:8001/health
# æœŸæœ›ï¼šHealthy

# PostgreSQL
psql -h localhost -U devuser -d k_meg_dev -c "SELECT 1"
# æœŸæœ›ï¼šè¼¸å…¥å¯†ç¢¼ devpass123ï¼Œç„¶å¾Œè¿”å› 1

# Redis
redis-cli -h localhost ping
# æœŸæœ›ï¼šPONG
```

**âœ… æ‰€æœ‰æœå‹™éƒ½é‹è¡ŒæˆåŠŸï¼** é–‹å§‹é–‹ç™¼å§ã€‚

---

## ğŸ“± è¨ªå•åœ°å€

é–‹ç™¼ç’°å¢ƒå•Ÿå‹•å¾Œï¼Œå¯ä»¥è¨ªå•ä»¥ä¸‹åœ°å€ï¼š

| æœå‹™ | URL | ç”¨é€” |
|------|-----|------|
| **Python Fast API** | http://localhost:8000 | å¾Œç«¯ API |
| **API æ–‡æª”** | http://localhost:8000/docs | Swagger äº’å‹•å¼æ–‡æª” |
| **TypeScript React** | http://localhost:5173 | å‰ç«¯æ‡‰ç”¨ |
| **C# .NET** | http://localhost:8001 | å‚™é¸å¾Œç«¯ |
| **PostgreSQL** | localhost:5432 | æ•¸æ“šåº« |
| **PgAdmin** | http://localhost:5050 | æ•¸æ“šåº«ç®¡ç† |
| **Redis** | localhost:6379 | ç·©å­˜å±¤ |
| **Redis Commander** | http://localhost:8081 | Redis å¯è¦–åŒ– |
| **MailCatcher** | http://localhost:1080 | éƒµä»¶æ¸¬è©¦ |

### PgAdmin ç™»éŒ„

```
Email: admin@k-meg.local
Password: admin123

é€£æ¥æ–°æœå‹™å™¨ï¼š
Hostname: postgres
Port: 5432
Username: devuser
Password: devpass123
Database: k_meg_dev
```

---

## ğŸ› ï¸ å¸¸è¦‹æ“ä½œ

### æŸ¥çœ‹æ—¥èªŒ

```bash
# æ‰€æœ‰æœå‹™çš„æ—¥èªŒ
docker compose logs -f

# åªçœ‹ç‰¹å®šæœå‹™
docker compose logs -f backend-python
docker compose logs -f frontend
docker compose logs -f postgres

# æŸ¥çœ‹æœ€å¾Œ 50 è¡Œ
docker compose logs --tail 50 backend-python

# æŸ¥çœ‹ä¸¦è·Ÿè¹¤ (é¡ä¼¼ tail -f)
docker compose logs -f backend-python
```

### é€²å…¥å®¹å™¨åŸ·è¡Œå‘½ä»¤

```bash
# é€²å…¥ Python å®¹å™¨çš„ bash
docker exec -it k-meg-backend-python bash

# é‹è¡Œ Python å‘½ä»¤
docker exec k-meg-backend-python python -c "import app; print('OK')"

# é€²å…¥ PostgreSQL å®¹å™¨
docker exec -it k-meg-postgres psql -U devuser -d k_meg_dev

# é€²å…¥ Node å®¹å™¨
docker exec -it k-meg-frontend bash
```

### é‡æ–°å•Ÿå‹•æœå‹™

```bash
# é‡å•Ÿå–®å€‹æœå‹™
docker compose restart backend-python

# é‡å»º & é‡å•Ÿ
docker compose up -d --build backend-python

# é‡å•Ÿæ‰€æœ‰æœå‹™
docker compose restart
```

### æ¸…ç†å’Œé‡ç½®

```bash
# åœæ­¢æ‰€æœ‰å®¹å™¨ä½†ä¿ç•™æ•¸æ“š
docker compose stop

# åœæ­¢ä¸¦åˆªé™¤å®¹å™¨
docker compose down

# åœæ­¢ & åˆªé™¤å®¹å™¨ + åˆªé™¤æ•¸æ“šå·ï¼ˆâš ï¸ æœƒä¸Ÿå¤±æ•¸æ“šåº«æ•¸æ“šï¼‰
docker compose down -v

# é‡æ–°æ§‹å»ºæ‰€æœ‰é¡åƒ
docker compose build --no-cache
```

### é‹è¡Œæ•¸æ“šåº«é·ç§»

```bash
# Python FastAPI + Alembic é·ç§»
docker exec k-meg-backend-python alembic upgrade head

# C# .NET Entity Framework é·ç§»
docker exec k-meg-backend-csharp dotnet ef database update
```

### é‹è¡Œæ¸¬è©¦

```bash
# Python å–®å…ƒæ¸¬è©¦
docker exec k-meg-backend-python pytest tests/ -v --cov=app

# TypeScript å–®å…ƒæ¸¬è©¦
docker exec k-meg-frontend npm run test

# C# å–®å…ƒæ¸¬è©¦
docker exec k-meg-backend-csharp dotnet test
```

---

## âš¡ é€²éšåŠŸèƒ½

### å•Ÿç”¨å¯é¸æœå‹™

```bash
# ä½¿ç”¨ profile å•Ÿç”¨é–‹ç™¼å·¥å…·
docker compose --profile dev up -d

# é€™æœƒé¡å¤–å•Ÿå‹•ï¼š
# - pgadmin (PostgreSQL ç®¡ç†)
# - redis-commander (Redis å¯è¦–åŒ–)
# - api-docs (Swagger UI)
# - mailcatcher (éƒµä»¶æ¸¬è©¦)
```

### æœ¬åœ°æŒä¹…åŒ–æ•¸æ“š

æ‰€æœ‰æ•¸æ“šè‡ªå‹•ä¿å­˜åˆ°æœ¬åœ° Docker å·ï¼š

```bash
# æŸ¥çœ‹å·
docker volume ls | grep k-meg

# å·å…§å®¹ä½ç½®ï¼š
# Linux/Mac: /var/lib/docker/volumes/k-meg_postgres_data/_data
# Windows: \\wsl$\docker-desktop-data\mnt\wsl\docker\volumes\...
```

### ç·¨è¼¯ç’°å¢ƒè®Šæ•¸

ä¿®æ”¹ `docker-compose.yml` ä¸­çš„ `environment` éƒ¨åˆ†ï¼Œç„¶å¾Œé‡å•Ÿï¼š

```yaml
backend-python:
  environment:
    LOG_LEVEL: DEBUG  # æ”¹æˆ DEBUG
    DEBUG: "true"     # æ”¹æˆ "false" é—œé–‰
```

```bash
# æ‡‰ç”¨è®Šæ›´
docker compose up -d backend-python
```

---

## ğŸ› æ•…éšœæ’é™¤

### å•é¡Œ 1: Port å·²è¢«å ç”¨

**ç—‡ç‹€ï¼š**
```
Error response from daemon: Ports are not available: exposing port TCP 0.0.0.0:5432 -> 0.0.0.0:5432
```

**è§£æ±ºï¼š**

```bash
# æŸ¥æ‰¾ä½”ç”¨ port çš„é€²ç¨‹
lsof -i :5432  # Mac/Linux
netstat -ano | findstr :5432  # Windows

# æ®ºæ­»é€²ç¨‹
kill -9 <PID>  # Mac/Linux
taskkill /PID <PID> /F  # Windows

# æˆ–æ”¹ç”¨ä¸åŒçš„ port
# ç·¨è¼¯ docker-compose.yml:
# postgres:
#   ports:
#     - "5433:5432"  # â† æ”¹æˆ 5433
```

### å•é¡Œ 2: Docker Daemon æœªå•Ÿå‹•

**ç—‡ç‹€ï¼š**
```
Cannot connect to the Docker daemon
```

**è§£æ±ºï¼š**

```bash
# Windows: å•Ÿå‹• Docker Desktop
# Mac: å•Ÿå‹• Docker.app
# Linux: å•Ÿå‹• docker æœå‹™
sudo systemctl start docker
```

### å•é¡Œ 3: å®¹å™¨å•Ÿå‹•å¤±æ•—

**è¨ºæ–·ï¼š**

```bash
# æŸ¥çœ‹è©³ç´°éŒ¯èª¤
docker compose logs --tail 100 <service-name>

# ä¾‹å¦‚ Python å¾Œç«¯
docker compose logs --tail 100 backend-python
```

**å¸¸è¦‹éŒ¯èª¤ï¼š**

```
# âŒ Import Error: æ‰¾ä¸åˆ°æ¨¡å¡Š
â†’ æª¢æŸ¥ requirements.txt æ˜¯å¦æ­£ç¢º

# âŒ Connection refused: PostgreSQL
â†’ æª¢æŸ¥ postgres å®¹å™¨æ˜¯å¦å¥åº·ï¼ˆdocker compose psï¼‰

# âŒ npm ERR! 404 Not Found
â†’ åˆªé™¤ node_modulesï¼Œé‡æ–°å®‰è£ï¼š
   docker compose down
   docker volume prune  # æ¸…ç†æœªä½¿ç”¨å·
   docker compose up -d frontend
```

### å•é¡Œ 4: æ•¸æ“šåº«é€£æ¥å¤±æ•—

**è¨ºæ–·ï¼š**

```bash
# æ¸¬è©¦ PostgreSQL é€£æ¥
docker exec k-meg-postgres psql -U devuser -d k_meg_dev -c "SELECT 1"

# æŸ¥çœ‹ postgres æ—¥èªŒ
docker compose logs postgres

# æª¢æŸ¥ DATABASE_URL ç’°å¢ƒè®Šæ•¸
docker exec k-meg-backend-python env | grep DATABASE
```

### å•é¡Œ 5: æ€§èƒ½å•é¡Œï¼ˆå®¹å™¨å¾ˆæ…¢ï¼‰

**åŸå› ï¼š** Docker Desktop è³‡æºä¸è¶³

**è§£æ±ºï¼š**

```
Windows/Mac:
1. æ‰“é–‹ Docker Desktop
2. Settings â†’ Resources
3. å¢åŠ  CPU å’Œå…§å­˜åˆ†é…ï¼ˆå»ºè­° 4-8 GBï¼‰
4. é‡å•Ÿ Docker

Linux:
1. æª¢æŸ¥ç³»çµ±è³‡æº: free -h
2. å¢åŠ  swap: sudo fallocate -l 4G /swapfile
```

---

## ğŸ”„ é–‹ç™¼å·¥ä½œæµ

### æ—¥å¸¸é–‹ç™¼

```bash
# ä¸Šç­é–‹å§‹ï¼šå•Ÿå‹•ç’°å¢ƒ
docker compose up -d

# æ­£å¸¸é–‹ç™¼ï¼ˆä»£ç¢¼åœ¨æœ¬åœ°ç·¨è¼¯ï¼Œå®¹å™¨è‡ªå‹•é‡æ–°åŠ è¼‰ï¼‰
# Python: Uvicorn è¨­ç½®äº† --reload
# React: Vite è‡ªå‹•ç†±æ›´æ–°
# .NET: Dotnet watchï¼ˆå¯é¸é…ç½®ï¼‰

# æäº¤ä»£ç¢¼å‰ï¼šæœ¬åœ°æª¢æŸ¥
npm run lint     # å‰ç«¯
pytest           # Python
dotnet build     # C#

# ä¸‹ç­/æœƒè­°ï¼šæš«åœç’°å¢ƒ
docker compose stop

# é‡æ–°å•Ÿå‹•ï¼ˆæ•¸æ“šä¿ç•™ï¼‰
docker compose start
```

### å°‡æ•¸æ“šåº«é‡ç½®ç‚ºåˆå§‹ç‹€æ…‹

```bash
# æ–¹å¼ 1: åªåˆªé™¤æ•¸æ“šï¼Œä¿ç•™è¡¨çµæ§‹
docker exec k-meg-postgres psql -U devuser -d k_meg_dev -c "TRUNCATE TABLE users CASCADE;"

# æ–¹å¼ 2: å®Œå…¨åˆªé™¤æ•¸æ“šå·ï¼ˆâš ï¸ æœƒä¸Ÿå¤±æ‰€æœ‰æ•¸æ“šï¼‰
docker compose down -v

# æ–¹å¼ 3: å›æ»¾é·ç§»
docker exec k-meg-backend-python alembic downgrade -1
```

---

## ğŸ“š ç›¸é—œæ–‡æª”

- [Docker å®˜æ–¹æ–‡æª”](https://docs.docker.com/)
- [Docker Compose æ–‡æª”](https://docs.docker.com/compose/)
- [é …ç›®æ¨£æ¿æŒ‡å—](../Project-Templates/)
- [ä»£ç¢¼å“è³ªè‡ªå‹•åŒ–](../CI-CD-Pipelines/)

---

## ğŸ’¬ å¸¸è¦‹å•é¡Œ

**Q: æ¯æ¬¡éƒ½è¦ up -d å—ï¼Ÿ**

A: ä¸éœ€è¦ã€‚å®¹å™¨æœƒä¿ç•™åœ¨å¾Œå°ã€‚åªéœ€ï¼š
```bash
docker compose start   # å•Ÿå‹•
docker compose stop    # åœæ­¢
docker compose restart # é‡å•Ÿ
```

**Q: æ•¸æ“šåº«æœƒä¸Ÿå¤±å—ï¼Ÿ**

A: ä¸æœƒã€‚æ•¸æ“šå­˜å„²åœ¨ Docker å·ä¸­ï¼Œé‡å•Ÿå®¹å™¨ä¸æœƒä¸Ÿå¤±ã€‚åªæœ‰åŸ·è¡Œ `down -v` æ‰æœƒåˆªé™¤ã€‚

**Q: å¦‚ä½•åœ¨å¤šå€‹é …ç›®é–“åˆ‡æ›ï¼Ÿ**

A: ä½¿ç”¨ä¸åŒç›®éŒ„ï¼š
```bash
cd project-a && docker compose up -d
# å¦é–‹çµ‚ç«¯
cd project-b && docker compose up -d

# å…©å€‹é …ç›®åŒæ™‚é‹è¡Œï¼ˆå¦‚æœ port ä¸è¡çªï¼‰
```

**Q: å¯ä»¥åªå•Ÿå‹•éƒ¨åˆ†æœå‹™å—ï¼Ÿ**

A: å¯ä»¥ï¼š
```bash
# åªå•Ÿå‹•æ•¸æ“šåº«å’Œå¾Œç«¯
docker compose up -d postgres redis backend-python

# ä¸å•Ÿå‹•å‰ç«¯
```

**Q: å¦‚ä½•ä¿®æ”¹æ™‚å€ï¼Ÿ**

A: åœ¨ `docker-compose.yml` ä¸­æ·»åŠ ï¼š
```yaml
environment:
  TZ: Asia/Taipei  # æ”¹æˆä½ çš„æ™‚å€
```

---

**æº–å‚™å¥½äº†å—ï¼Ÿ åŸ·è¡Œ `docker compose up -d`ï¼Œç„¶å¾Œé–‹å§‹é–‹ç™¼ï¼** ğŸš€
